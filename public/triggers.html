<!DOCTYPE html>
<html lang="zh">

<head>
	<meta charset="UTF-8">
	<title>测试主页</title>
	<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
	<script>
		function getForm() {
			let obj = {};
			obj.group_id = $("#group_id")[0].valueAsNumber;
			obj.user_id = $("#user_id")[0].valueAsNumber;
			obj.trigger_type = $("#trigger_type")[0].value;
			obj.response = $("#response")[0].value;
			obj.priority = $("#priority")[0].valueAsNumber;
			obj.block = $("#block")[0].checked;
			return obj;
		}
		$(document).ready(function () {
			alert("此页面仅供测试，未作输入验证，任何非法输入都可能导致程序崩溃");
			$("#add_rule").click(function () {
				$.post({
					url: "/api/v1/triggers",
					data: JSON.stringify(getForm()),
					contentType: 'application/json',
				}).done(function (data) {
					alert(JSON.stringify(data));
				})
			});
			$("#delete_rule").click(function () {
				let trigger_id = $("#trigger_id")[0].valueAsNumber;
				$.ajax({
					url: "/api/v1/triggers/" + trigger_id,
					type: "DELETE",
					success: function (result) {
						alert(JSON.stringify(result));
					}
				});
			});
		});
	</script>
</head>

<body>
	<h1>测试主页</h1>
	<div>
		<a href="/api/v1/triggers" target="_blank">查看所有规则</a>
	</div>
	<br /><br />
	<div>
		<form>
			群号: <input id="group_id" type="number">（全部则填0）<br />
			QQ号: <input id="user_id" type="number">（全部则填0）<br />
			种类:
			<select id="trigger_type">
				<option value="friend">加好友请求</option>
				<option value="friend_add">好友添加成功</option>
				<option value="group/add">加群请求</option>
				<option value="group/invite">加群邀请</option>
				<option value="group_upload">群文件上传</option>
				<option value="group_admin/set">群管理员新增</option>
				<option value="group_admin/unset">群管理员取消</option>
				<option value="group_decrease">群成员减少</option>
				<option value="group_decrease/leave">群成员主动退群</option>
				<option value="group_decrease/kick">群成员被踢</option>
				<option value="group_decrease/kick_me">自己被踢</option>
				<option value="group_increase">群成员增加</option>
				<option value="group_increase/approve">管理员同意入群</option>
				<option value="group_increase/invite">管理员邀请入群</option>
				<option value="group_ban/ban">群成员被禁言</option>
				<option value="group_recall">群消息撤回</option>
				<option value="friend_recall">好友消息撤回</option>
				<option value="poke">群内戳一戳</option>
			</select><br />
			回应: <textarea id="response" cols="60" rows="5"></textarea><br />
			优先级: <input id="priority" type="number"><br />
			阻止后续: <input id="block" type="checkbox"><br />
		</form>
		<button id="add_rule">新增规则</button>
	</div>
	<br /><br />
	<div>
		规则号: <input id="trigger_id" type="number">
		<button id="delete_rule">删除规则</button>
	</div>
</body>

</html>